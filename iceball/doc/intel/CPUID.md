# CPUID

CPU Identification

The ID flag (bit 21) in the EFLAGS register indicates support for the CPUID instruction.
If a software procedure can set and clear this flag, the processor executing the procedure supports the CPUID instruction.
This instruction operates the same in non-64-bit modes and 64-bit mode.1CPUID returns processor identification and feature information in the EAX, EBX, ECX, and EDX registers.
The instruction's output is dependent on the contents of the EAX register upon execution (in some cases, ECX as well).
For example, the following pseudocode loads EAX with 00H and causes CPUID to return a Maximum Return Value and the Vendor Identification String in the appropriate registers:MOV EAX, 00HCPUIDTable 3-8 shows information returned, depending on the initial value loaded into the EAX register.
Two types of information are returned: basic and extended function information.
If a value entered for CPUID.EAX is higher than the maximum input value for basic or extended function for that processor then the data for the highest basic information leaf is returned.
For example, using some Intel processors, the following is true:CPUID.EAX = 05H (* Returns MONITOR/MWAIT leaf.
*) CPUID.EAX = 0AH (* Returns Architectural Performance Monitoring leaf.
*) 2 CPUID.EAX = 0BH (* Returns Extended Topology Enumeration leaf.
*)2CPUID.EAX =1FH (* Returns V2 Extended Topology Enumeration leaf.
*) CPUID.EAX = 80000008H (* Returns linear/physical address size data.
*)CPUID.EAX = 8000000AH (* INVALID: Returns same information as CPUID.EAX = 0BH.
*)If a value entered for CPUID.EAX is less than or equal to the maximum input value and the leaf is not supported on that processor then 0 is returned in all the registers.When CPUID returns the highest basic leaf information as a result of an invalid input EAX value, any dependence on input ECX value in the basic leaf is honored.CPUID can be executed at any privilege level to serialize instruction execution.
Serializing instruction execution guarantees that any modifications to flags, registers, and memory for previous instructions are completed before the next instruction is fetched and executed.See also: ® "Serializing Instructions" in Chapter 9, "Multiple-Processor Management," in the Intel64 and IA-32 Architectures Software Developer's Manual, Volume 3A.® "Caching Translation Information" in Chapter 4, "Paging," in the Intel64 and IA-32 Architectures Software Devel-oper's Manual, Volume 3A.

## Flags affected

- None.Exceptions (All Operating Modes)#UD If the LOCK prefix is used.

## Operation

```C
:= IA32_BIOS_SIGN_ID MSR Update with installed microcode revision number;CASE (EAX) OF= EAX 0::= EAX Highest basic function input value understood by CPUID;:= EBX Vendor identification string;:= EDX Vendor identification string;:= ECX Vendor identification string;BREAK;= 1H:EAX := EAX[3:0] Stepping ID; := EAX[7:4] Model; := := EAX[13:12] Processor type; := EAX[15:14] Reserved;:= EAX[19:16] Extended Model;:= EAX[27:20] Extended Family;:= EAX[31:28] Reserved;:= EBX[7:0] Brand Index; (* Reserved if the value is zero. *):= EBX[15:8] CLFLUSH Line Size;:= EBX[16:23] Reserved; (* Number of threads enabled = 2 if MT enable fuse set. *):= EBX[24:31] Initial APIC ID;:= ECX Feature flags; (* See Figure3-7. *):= EDX Feature flags; (* See Figure3-8. *)BREAK;= 2H:EAX := EAX Cache and TLB information; :=  EBX Cache and TLB information; :=  ECX Cache and TLB information; := EDX Cache and TLB information; BREAK;= 3H:EAX := EAX Reserved; :=  EBX Reserved; :=  ECX ProcessorSerialNumber[31:0]; (* Pentium III processors only, otherwise reserved. *):= ProcessorSerialNumber[63:32]; EDX (* Pentium III processors only, otherwise reserved. *BREAK = 4H:EAX:= EAX Deterministic Cache Parameters Leaf; (* See Table 3-8. *):= EBX Deterministic Cache Parameters Leaf; :=  ECX Deterministic Cache Parameters Leaf; := EDX Deterministic Cache Parameters Leaf; BREAK;= 5H:EAX := EAX MONITOR/MWAIT Leaf; (* See Table 3-8. *):=  EBX MONITOR/MWAIT Leaf; :=  ECX MONITOR/MWAIT Leaf; := EDX MONITOR/MWAIT Leaf; BREAK;= 6H:EAX := EAX Thermal and Power Management Leaf; (* See Table 3-8. *):=  EBX Thermal and Power Management Leaf; :=  ECX Thermal and Power Management Leaf; := EDX Thermal and Power Management Leaf; BREAK; = 7H:EAX:= EAX Structured Extended Feature Flags Enumeration Leaf; (* See Table 3-8. *):= EBX Structured Extended Feature Flags Enumeration Leaf; :=  ECX Structured Extended Feature Flags Enumeration Leaf; := EDX Structured Extended Feature Flags Enumeration Leaf; BREAK;= 8H:EAX := EAX Reserved = 0;:=  EBX Reserved = 0; := := EDX Reserved = 0; BREAK;= 9H:EAX  := EAXDirect Cache Access Information Leaf; (* See Table 3-8. *):=  EBX Direct Cache Access Information Leaf; :=  ECX Direct Cache Access Information Leaf; := EDX Direct Cache Access Information Leaf; BREAK;= AH:EAX := EAX Architectural Performance Monitoring Leaf; (* See Table 3-8. *):=  EBX Architectural Performance Monitoring Leaf; :=  ECX Architectural Performance Monitoring Leaf; := EDX Architectural Performance Monitoring Leaf; BREAK =EAX BH::= EAX Extended Topology Enumeration Leaf; (* See Table 3-8. *):= EBX Extended Topology Enumeration Leaf; :=  ECX Extended Topology Enumeration Leaf; := EDX Extended Topology Enumeration Leaf; BREAK;= CH:EAX := EAX Reserved = 0;:=  EBX Reserved = 0; :=  ECX Reserved = 0; := EDX Reserved = 0; BREAK;= DH:EAX  := EAXProcessor Extended State Enumeration Leaf; (* See Table 3-8. *):=  EBX Processor Extended State Enumeration Leaf; :=  ECX Processor Extended State Enumeration Leaf; := EDX Processor Extended State Enumeration Leaf; BREAK;= EH:EAX := EAX Reserved = 0;:=  EBX Reserved = 0; :=  ECX Reserved = 0; := EDX Reserved = 0; BREAK;= FH:EAX  := EAXIntel Resource Director Technology Monitoring Enumeration Leaf; (* See Table 3-8. *):=  EBX Intel Resource Director Technology Monitoring Enumeration Leaf; :=  ECX Intel Resource Director Technology Monitoring Enumeration Leaf; := EDX Intel Resource Director Technology Monitoring Enumeration Leaf; BREAK;= 10H:EAX  := EAXIntel Resource Director Technology Allocation Enumeration Leaf; (* See Table 3-8. *):=  EBX Intel Resource Director Technology Allocation Enumeration Leaf; :=  ECX Intel Resource Director Technology Allocation Enumeration Leaf; := EDX Intel Resource Director Technology Allocation Enumeration Leaf; BREAK;= 12H:EAX  := EAXIntel SGX Enumeration Leaf; (* See Table 3-8. *):=  EBX Intel SGX Enumeration Leaf; := := EDX Intel SGX Enumeration Leaf; BREAK;= 14H:EAX  := EAXIntel Processor Trace Enumeration Leaf; (* See Table 3-8. *):=  EBX Intel Processor Trace Enumeration Leaf; :=  ECX Intel Processor Trace Enumeration Leaf; := EDX Intel Processor Trace Enumeration Leaf; BREAK;= 15H:EAX  := EAXTime Stamp Counter and Nominal Core Crystal Clock Information Leaf; (* See Table 3-8. *):=  EBX Time Stamp Counter and Nominal Core Crystal Clock Information Leaf; :=  ECX Time Stamp Counter and Nominal Core Crystal Clock Information Leaf; := EDX Time Stamp Counter and Nominal Core Crystal Clock Information Leaf; BREAK;= 16H:EAX  := EAXProcessor Frequency Information Enumeration Leaf; (* See Table 3-8. *):=  EBX Processor Frequency Information Enumeration Leaf; :=  ECX Processor Frequency Information Enumeration Leaf; := EDX Processor Frequency Information Enumeration Leaf; BREAK;= 17H:EAX  := EAXSystem-On-Chip Vendor Attribute Enumeration Leaf; (* See Table 3-8. *):=  EBX System-On-Chip Vendor Attribute Enumeration Leaf; :=  ECX System-On-Chip Vendor Attribute Enumeration Leaf; := EDX System-On-Chip Vendor Attribute Enumeration Leaf; BREAK;= 18H:EAX  := EAXDeterministic Address Translation Parameters Enumeration Leaf; (* See Table 3-8. *):=  EBX Deterministic Address Translation Parameters Enumeration Leaf; :=  ECX Deterministic Address Translation Parameters Enumeration Leaf; := EDX Deterministic Address Translation Parameters Enumeration Leaf; BREAK;=EAX  19H: := EAXKey Locker Enumeration Leaf; (* See Table 3-8. *):=  EBX Key Locker Enumeration Leaf; :=  ECX Key Locker Enumeration Leaf; := EDX Key Locker Enumeration Leaf; BREAK; = 1AH:EAX:= EAX Native Model ID Enumeration Leaf; (* See Table 3-8. *):= EBX Native Model ID Enumeration Leaf; :=  ECX Native Model ID Enumeration Leaf; := EDX Native Model ID Enumeration Leaf; BREAK; = 1BH:EAX:= EAX PCONFIG Information Enumeration Leaf; (* See "INPUT EAX = 1BH: Returns PCONFIG Information" on page 3-252. *):= EBX PCONFIG Information Enumeration Leaf; :=  ECX PCONFIG Information Enumeration Leaf; := EDX PCONFIG Information Enumeration Leaf; BREAK; = 1CH:EAX:= EAX Last Branch Record Information Enumeration Leaf; (* See Table 3-8. *):= EBX Last Branch Record Information Enumeration Leaf; := := EDX Last Branch Record Information Enumeration Leaf; BREAK; = 1DH:EAX :=EAX Tile Information Enumeration Leaf; (* See Table 3-8. *) :=EBX Tile Information Enumeration Leaf;  := ECX Tile Information Enumeration Leaf;  :=EDX Tile Information Enumeration Leaf; BREAK; = 1EH:EAX :=EAX TMUL Information Enumeration Leaf; (* See Table 3-8. *) :=EBX TMUL Information Enumeration Leaf;  := ECX TMUL Information Enumeration Leaf;  :=EDX TMUL Information Enumeration Leaf; BREAK; = 1FH:EAX:= EAX V2 Extended Topology Enumeration Leaf; (* See Table 3-8. *):= EBX V2 Extended Topology Enumeration Leaf; :=  ECX V2 Extended Topology Enumeration Leaf; := EDX V2 Extended Topology Enumeration Leaf; BREAK; = 20H:EAX:= EAX Processor History Reset Sub-leaf; (* See Table 3-8. *):= EBX Processor History Reset Sub-leaf; :=  ECX Processor History Reset Sub-leaf; := EDX Processor History Reset Sub-leaf; BREAK;EAX = 80000000H::= Highest extended function input value understood by CPUID;EAX := EBX Reserved; := ECX Reserved; := EDX Reserved; BREAK;= 80000001H:EAX := EAX Reserved; := EBX Reserved; := ECX Extended Feature Bits (* See Table 3-8.*); := EDX Extended Feature Bits (* See Table 3-8. *); BREAK; = 80000002H:EAX:= EAX Processor Brand String; := EBX Processor Brand String, continued;:= ECX Processor Brand String, continued; := EDX Processor Brand String, continued; BREAK; = 80000003H:EAX:= EAX Processor Brand String, continued; := EBX Processor Brand String, continued; := ECX Processor Brand String, continued; := EDX Processor Brand String, continued; BREAK;= 80000004H:EAX := EAX Processor Brand String, continued; := EBX Processor Brand String, continued; := := EDX Processor Brand String, continued;BREAK; = 80000005H:EAX:= EAX Reserved = 0; := EBX Reserved = 0; := ECX Reserved = 0; := EDX Reserved = 0; BREAK; = 80000006H:EAX:= EAX Reserved = 0; := EBX Reserved = 0; := ECX Cache information; := EDX Reserved = 0; BREAK; = 80000007H:EAX:= EAX Reserved = 0; := EBX Reserved = 0; := ECX Reserved = 0; := EDX Reserved = Misc Feature Flags; BREAK; = 80000008H:EAX:= EAX Address Size Information; := EBX Misc Feature Flags; := ECX Reserved = 0; := EDX Reserved = 0; BREAK;EAX >= 40000000H and EAX <= 4FFFFFFFH:DEFAULT: (* EAX = Value outside of recognized range for CPUID. *)(* If the highest basic information leaf data depend on ECX input value, ECX is honored.*):= Reserved; (* Information returned for highest basic information leaf. *)EAX := EBX Reserved; (* Information returned for highest basic information leaf. *):= ECX Reserved; (* Information returned for highest basic information leaf. *):= EDX Reserved; (* Information returned for highest basic information leaf. *)BREAK;ESAC;
```
